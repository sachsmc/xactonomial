<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Improved inference for a real-valued function of multinomial parameters — xactonomial • xactonomial</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Improved inference for a real-valued function of multinomial parameters — xactonomial"><meta name="description" content="We consider the k sample multinomial problem where we observe k vectors
(possibly of different lengths), each representing an independent sample from
a multinomial. For a given function \(\tau(\theta)\) which takes in the concatenated
vector of multinomial probabilities \(\theta\) and outputs a real number, we are
interested in computing a p-value for a test of \(\tau(\theta) = \psi \geq \psi_0\), and constructing
a confidence interval for \(\psi\)."><meta property="og:description" content="We consider the k sample multinomial problem where we observe k vectors
(possibly of different lengths), each representing an independent sample from
a multinomial. For a given function \(\tau(\theta)\) which takes in the concatenated
vector of multinomial probabilities \(\theta\) and outputs a real number, we are
interested in computing a p-value for a test of \(\tau(\theta) = \psi \geq \psi_0\), and constructing
a confidence interval for \(\psi\)."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">xactonomial</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/example.html">Basic Examples</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/sachsmc/xactonomial/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Improved inference for a real-valued function of multinomial parameters</h1>
      <small class="dont-index">Source: <a href="https://github.com/sachsmc/xactonomial/blob/HEAD/R/xactonomial.R" class="external-link"><code>R/xactonomial.R</code></a></small>
      <div class="d-none name"><code>xactonomial.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>We consider the k sample multinomial problem where we observe k vectors
(possibly of different lengths), each representing an independent sample from
a multinomial. For a given function \(\tau(\theta)\) which takes in the concatenated
vector of multinomial probabilities \(\theta\) and outputs a real number, we are
interested in computing a p-value for a test of \(\tau(\theta) = \psi \geq \psi_0\), and constructing
a confidence interval for \(\psi\).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">xactonomial</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">f_param</span>,</span>
<span>  statistic <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  psi0 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  alternative <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"two.sided"</span>, <span class="st">"less"</span>, <span class="st">"greater"</span><span class="op">)</span>,</span>
<span>  <span class="va">psi_limits</span>,</span>
<span>  theta_null_points <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  p_target <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  conf_int <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  conf_level <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  itp_maxit <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  itp_eps <span class="op">=</span> <span class="fl">0.005</span>,</span>
<span>  p_value_limits <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  maxit <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  chunksize <span class="op">=</span> <span class="fl">500</span>,</span>
<span>  theta_sampler <span class="op">=</span> <span class="va">runif_dk_vects</span>,</span>
<span>  ga <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  ga_gfactor <span class="op">=</span> <span class="st">"adapt"</span>,</span>
<span>  ga_lrate <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>  ga_restart_every <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">503</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A list with k elements representing the vectors of counts of a
k-sample multinomial</p></dd>


<dt id="arg-f-param">f_param<a class="anchor" aria-label="anchor" href="#arg-f-param"></a></dt>
<dd><p>Function that takes in parameters and outputs psi, a real
valued number for each parameter. Can be vectorized rowwise for a matrix or not.</p></dd>


<dt id="arg-statistic">statistic<a class="anchor" aria-label="anchor" href="#arg-statistic"></a></dt>
<dd><p>Function that takes in a matrix with data vectors in the rows, and outputs a vector with the number of rows in the matrix. If NULL, will be inferred from <code>f_param</code> by plugging in the empirical proportions.</p></dd>


<dt id="arg-psi-">psi0<a class="anchor" aria-label="anchor" href="#arg-psi-"></a></dt>
<dd><p>The null hypothesis value for the parameter being tested.</p></dd>


<dt id="arg-alternative">alternative<a class="anchor" aria-label="anchor" href="#arg-alternative"></a></dt>
<dd><p>a character string specifying the alternative hypothesis, must be one of "two.sided" (default), "greater" or "less"</p></dd>


<dt id="arg-psi-limits">psi_limits<a class="anchor" aria-label="anchor" href="#arg-psi-limits"></a></dt>
<dd><p>A vector of length 2 giving the lower and upper limits of
the range of \(\tau(\theta)\)</p></dd>


<dt id="arg-theta-null-points">theta_null_points<a class="anchor" aria-label="anchor" href="#arg-theta-null-points"></a></dt>
<dd><p>An optional matrix where each row is a theta value that gives <code>f_param(theta) = psi0</code>. If this is supplied and psi0 = one of <code>psi_limits</code>, then a truly exact p-value will be calculated.</p></dd>


<dt id="arg-p-target">p_target<a class="anchor" aria-label="anchor" href="#arg-p-target"></a></dt>
<dd><p>If a p-value is found that is greater than p_target, terminate the algorithm early.</p></dd>


<dt id="arg-conf-int">conf_int<a class="anchor" aria-label="anchor" href="#arg-conf-int"></a></dt>
<dd><p>If TRUE, calculates a confidence interval by inverting the p-value function</p></dd>


<dt id="arg-conf-level">conf_level<a class="anchor" aria-label="anchor" href="#arg-conf-level"></a></dt>
<dd><p>A number between 0 and 1, the confidence level.</p></dd>


<dt id="arg-itp-maxit">itp_maxit<a class="anchor" aria-label="anchor" href="#arg-itp-maxit"></a></dt>
<dd><p>Maximum iterations to use in the ITP algorithm. Only relevant if conf_int = TRUE.</p></dd>


<dt id="arg-itp-eps">itp_eps<a class="anchor" aria-label="anchor" href="#arg-itp-eps"></a></dt>
<dd><p>Epsilon value to use for the ITP algorithm. Only relevant if conf_int = TRUE.</p></dd>


<dt id="arg-p-value-limits">p_value_limits<a class="anchor" aria-label="anchor" href="#arg-p-value-limits"></a></dt>
<dd><p>A vector of length 2 giving lower bounds on the one-sided p-values corresponding to psi0 = psi_limits, with alternative = "less" and "greater", respectively. Only relevant if conf_int = TRUE. See examples.</p></dd>


<dt id="arg-maxit">maxit<a class="anchor" aria-label="anchor" href="#arg-maxit"></a></dt>
<dd><p>Maximum number of iterations of the Monte Carlo procedure</p></dd>


<dt id="arg-chunksize">chunksize<a class="anchor" aria-label="anchor" href="#arg-chunksize"></a></dt>
<dd><p>The number of samples to take from the parameter space at each iteration</p></dd>


<dt id="arg-theta-sampler">theta_sampler<a class="anchor" aria-label="anchor" href="#arg-theta-sampler"></a></dt>
<dd><p>Function to take samples from the \(Theta\) parameter space. Default is <a href="runif_dk_vects.html">runif_dk_vects</a>. Must be a function of two parameters <code>d_k</code> a vector of dimensions, and <code>chunksize</code> the number of samples to take, and return a matrix with <code>sum(d_k)</code> columns and <code>chunksize</code> rows. See examples.</p></dd>


<dt id="arg-ga">ga<a class="anchor" aria-label="anchor" href="#arg-ga"></a></dt>
<dd><p>Logical, if TRUE, uses gradient ascent.</p></dd>


<dt id="arg-ga-gfactor">ga_gfactor<a class="anchor" aria-label="anchor" href="#arg-ga-gfactor"></a></dt>
<dd><p>Concentration parameter scale in the gradient ascent algorithm. A number or "adapt"</p></dd>


<dt id="arg-ga-lrate">ga_lrate<a class="anchor" aria-label="anchor" href="#arg-ga-lrate"></a></dt>
<dd><p>The gradient ascent learning rate</p></dd>


<dt id="arg-ga-restart-every">ga_restart_every<a class="anchor" aria-label="anchor" href="#arg-ga-restart-every"></a></dt>
<dd><p>Restart the gradient ascent after this number of iterations at a sample from <code>theta_sampler</code></p></dd>


<dt id="arg-seed">seed<a class="anchor" aria-label="anchor" href="#arg-seed"></a></dt>
<dd><p>Seed for the random number generator. Can be set to NULL in which case no seed is set.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An object of class "htest", which is a list with the following elements:</p><dl><dt>estimate</dt>
<dd><p>The value of the statistic at the observed data</p></dd>

<dt>p.value</dt>
<dd><p>The p value</p></dd>

<dt>conf.int</dt>
<dd><p>The upper and lower confidence limits</p></dd>

<dt>null.value</dt>
<dd><p>The null hypothesis value provided by the user</p></dd>

<dt>alternative</dt>
<dd><p>The type of test</p></dd>

<dt>method</dt>
<dd><p>A description of the method</p></dd>

<dt>data.name</dt>
<dd><p>The name of the data object provided by the user</p></dd>

<dt>p.sequence</dt>
<dd><p>A list with two elements, p.null and p.alt containing the vector of p values at each iteration for the less than null and the greater than null. Used for assessing convergence.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Let \(T_j\) be distributed
\(\mbox{Multinomial}_{d_j}(\boldsymbol{\theta}_j, n_j)\) for \(j = 1,
\ldots, k\) and denote \(\boldsymbol{T} = (T_1, \ldots, T_k)\) and
\(\boldsymbol{\theta} = (\theta_1, \ldots, \theta_k)\). The subscript
\(d_j\) denotes the dimension of the multinomial. Suppose one is interested
in the parameter \(\psi = \tau(\boldsymbol{\theta}) \in \Psi \subseteq
\mathbb{R}\). Given a sample of size \(n\) from \(\boldsymbol{T}\), say
\(\boldsymbol{X} = (X_1, \ldots, X_k)\), which is a vector of counts obtained
by concatenating the k independent count vectors, let \(G(\boldsymbol{X})\)
denote a real-valued statistic that defines the ordering of the sample space.
Tne default choice of the statistic is to estimate \(\boldsymbol{\theta}\)
with the sample proportions and plug them into \(\tau(\boldsymbol{\theta})\).
This function calculates a p value for a test of the null hypothesis
\(H_0: \psi \neq \psi_0\) for the two sided case,
\(H_0: \psi \leq \psi_0\) for the case <code>alternative = "greater"</code>, and
\(H_0: \psi \geq \psi_0\) for the case <code>alternative = "less"</code>.
We make no assumptions and do not rely on large sample approximations.
It also optionally constructs a \(1 - \alpha\) percent confidence interval for \(\psi\).
The computation is somewhat involved so it is best for small sample sizes. The
calculation is done by sampling a large number of points from the null parameter space \(\Theta_0\),
then computing multinomial probabilities under those values for the range of the sample space
where the statistic is as or more extreme than the observed statistic given data. It
is basically the definition of a p-value implemented with Monte Carlo methods. Some
options for speeding up the calculation are available.</p>
    </div>
    <div class="section level2">
    <h2 id="specifying-the-function-tau-cdot-">Specifying the function \(\tau(\cdot)\)<a class="anchor" aria-label="anchor" href="#specifying-the-function-tau-cdot-"></a></h2>


<p>This function is the <code>f_param</code> argument and should be a function that either: 1)
takes a vector of length sum(d_j) (the total number of bins) and outputs a single number, or 2) takes a
matrix with number of columns equal to sum(d_j), and arbitrary number of rows and
outputs a vector with length equal to the number of rows. In other words, psi can be
not vectorized or it can be vectorized by row. Writing it so that it is vectorized
can speed up the calculation. See examples.</p>
    </div>
    <div class="section level2">
    <h2 id="boundary-issues">Boundary issues<a class="anchor" aria-label="anchor" href="#boundary-issues"></a></h2>


<p>It is required to provide <code>psi_limits</code>, a vector of length 2 giving the
smallest and largest possible values that the function psi can take, e.g., <code>c(0, 1)</code>.
If the null hypothesis value psi0 is at one of the limits, it is often the case
that sampling from the null parameter space is impossible because it is a set of
measure 0. While it may have measure 0, it is not empty, and will contain a finite
set of points. Thus you should provide the argument <code>theta_null_points</code> which is
a matrix where the rows contain the finite set (sometimes 1) of points
\(\theta\) such that \(\tau(\theta) = \psi_0\). There is also an argument called
<code>p_value_limits</code> that can be used to improve performance of confidence intervals
around the boundary. This should be a vector of length 2 with the p-value for a test
of psi_0 &lt;= psi_limits[1] and the p-value for a test of psi_0 &gt;= psi_limits[2].
See examples.</p>
    </div>
    <div class="section level2">
    <h2 id="optimization-options">Optimization options<a class="anchor" aria-label="anchor" href="#optimization-options"></a></h2>


<p>For p-value calculation, you can provide a parameter p_target, so that the sampling
algorithm terminates when a p-value is found that exceeds p_target. The algorithm
begins by sampling uniformly from the unit simplices defining the parameter space, but
alternatives can be specified in <code>theta_sampler</code>. By default
gradient ascent (<code>ga = TRUE</code>) is performed during the p-value maximization
procedure, and <code>ga_gfactor</code> and <code>ga_lrate</code> control options for the gradient
ascent. At each iteration, the gradient of the multinomial probability at the current maximum
theta is computed, and a step is taken to <code>theta + lrate * gradient</code>. Then
for the next iteration, a set of <code>chunksize</code> samples are drawn from a Dirichlet distribution
with parameter <code>ga_gfactor * (theta + ga_lrate * gradient)</code>. If <code>ga_gfactor = "adapt"</code> then
it is set to <code>1 / max(theta)</code> at each iteration. The ITP algorithm <a href="itp_root.html">itp_root</a> is used
to find roots of the p-value function as a function of the psi0 value to get confidence intervals.
The maximum number of iterations and epsilon can be controlled via <code>itp_maxit, itp_eps</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Sachs, M.C., Gabriel, E.E. and Fay, M.P., 2024. Exact confidence intervals for functions of parameters in the k-sample multinomial problem. arXiv preprint arXiv:2406.19141.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">tau_ba</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">theta</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">theta1</span> <span class="op">&lt;-</span> <span class="va">theta</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span></span></span>
<span class="r-in"><span>  <span class="va">theta2</span> <span class="op">&lt;-</span> <span class="va">theta</span><span class="op">[</span><span class="fl">5</span><span class="op">:</span><span class="fl">8</span><span class="op">]</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">theta1</span> <span class="op">*</span> <span class="va">theta2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">}</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>T1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span>, T2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">xactonomial</span><span class="op">(</span><span class="va">data</span>, <span class="va">tau_ba</span>, psi_limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, psi0 <span class="op">=</span> <span class="fl">.5</span>,</span></span>
<span class="r-in"><span>  conf_int <span class="op">=</span> <span class="cn">FALSE</span>, maxit <span class="op">=</span> <span class="fl">15</span>, chunksize <span class="op">=</span> <span class="fl">200</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Monte Carlo multinomial test</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data:  data</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p-value = 0.02401</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alternative hypothesis: true psi0 is not equal to 0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 95 percent confidence interval:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sample estimates:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    tau_ba </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.7995291 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># vectorized by row</span></span></span>
<span class="r-in"><span><span class="va">tau_ba_v</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">theta</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="va">theta1</span> <span class="op">&lt;-</span> <span class="va">theta</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">theta2</span> <span class="op">&lt;-</span> <span class="va">theta</span><span class="op">[</span>,<span class="fl">5</span><span class="op">:</span><span class="fl">8</span>, drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">theta1</span> <span class="op">*</span> <span class="va">theta2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>T1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span>, T2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">xactonomial</span><span class="op">(</span><span class="va">data</span>, <span class="va">tau_ba_v</span>, psi_limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, psi0 <span class="op">=</span> <span class="fl">.5</span>,</span></span>
<span class="r-in"><span> conf_int <span class="op">=</span> <span class="cn">FALSE</span>, maxit <span class="op">=</span> <span class="fl">10</span>, chunksize <span class="op">=</span> <span class="fl">200</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Monte Carlo multinomial test</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data:  data</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p-value = 0.02401</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alternative hypothesis: true psi0 is not equal to 0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 95 percent confidence interval:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sample estimates:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  tau_ba_v </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.7995291 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="co"># example of using theta_null_points</span></span></span>
<span class="r-in"><span> <span class="co"># psi = 1/3 occurs when all probs = 1/3</span></span></span>
<span class="r-in"><span> <span class="va">tau_max</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">pp</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>   <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">pp</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">13</span>, <span class="fl">24</span>, <span class="fl">13</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">xactonomial</span><span class="op">(</span><span class="va">data</span>, <span class="va">tau_max</span>, psi_limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="fl">3</span>, <span class="fl">1</span><span class="op">)</span>, psi0 <span class="op">=</span> <span class="fl">1</span><span class="op">/</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>  conf_int <span class="op">=</span> <span class="cn">FALSE</span>, theta_null_points <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Exact multinomial test given a point null</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data:  data</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p-value = 0.1331</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alternative hypothesis: true psi0 is not equal to 0.3333333</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 95 percent confidence interval:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sample estimates:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> tau_max </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    0.48 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## in this case using p_value_limits improves confidence interval performance</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="fu">xactonomial</span><span class="op">(</span><span class="va">data</span>, <span class="va">tau_max</span>, psi_limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="fl">3</span>, <span class="fl">1</span><span class="op">)</span>, psi0 <span class="op">=</span> <span class="fl">1</span><span class="op">/</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>  conf_int <span class="op">=</span> <span class="cn">TRUE</span>, theta_null_points <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  p_value_limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.1</span>, <span class="fl">1e-8</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Exact multinomial test given a point null</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data:  data</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p-value = 0.1331</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alternative hypothesis: true psi0 is not equal to 0.3333333</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 95 percent confidence interval:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.3333333 0.6258333</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sample estimates:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> tau_max </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    0.48 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## specifying theta_sampler</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">dirich_sampler</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">d_k</span>, <span class="va">chunksize</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="rdirich_dk_vects.html">rdirich_dk_vects</a></span><span class="op">(</span><span class="va">chunksize</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">xactonomial</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span>,<span class="va">tau_max</span>,</span></span>
<span class="r-in"><span>            psi_limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.25</span>,<span class="fl">1</span><span class="op">)</span>, psi0 <span class="op">=</span> <span class="fl">.5</span>, conf_int <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>            theta_sampler <span class="op">=</span> <span class="va">dirich_sampler</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Monte Carlo multinomial test</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data:  list(1:4)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p-value = 0.6586</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alternative hypothesis: true psi0 is not equal to 0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 95 percent confidence interval:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sample estimates:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> tau_max </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     0.4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Michael C Sachs, Michael P Fay, Erin E Gabriel.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

