[{"path":"/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2024 Michael C Sachs Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":[]},{"path":"/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Michael C Sachs. Author, maintainer. Michael P Fay. Author.","code":""},{"path":"/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Sachs M, Fay M (2024). xactonomial: Exact Inference Real-Valued Functionals k-Sample Multinomial Parameters. R package version 0.1.0, https://github.com/sachsmc/xactonomial.","code":"@Manual{,   title = {xactonomial: Exact Inference for Real-Valued Functionals of k-Sample Multinomial Parameters},   author = {Michael C Sachs and Michael P Fay},   year = {2024},   note = {R package version 0.1.0},   url = {https://github.com/sachsmc/xactonomial}, }"},{"path":"/index.html","id":"xactonomial","dir":"","previous_headings":"","what":"Exact Inference for Real-Valued Functionals of k-Sample Multinomial Parameters","title":"Exact Inference for Real-Valued Functionals of k-Sample Multinomial Parameters","text":"goal xactonomial use exact (computational stochastic) method compute confidence interval function calculation p values k sample multinomial setting interest real-valued functional multinomial probabilities.","code":""},{"path":"/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Exact Inference for Real-Valued Functionals of k-Sample Multinomial Parameters","text":"can install development version xactonomial like :","code":"remotes::install_github(\"sachsmc/xactonomial\")"},{"path":"/index.html","id":"example","dir":"","previous_headings":"","what":"Example","title":"Exact Inference for Real-Valued Functionals of k-Sample Multinomial Parameters","text":"basic example shows use main function:","code":"library(xactonomial)  psi_ba <- function(theta) {    theta1 <- theta[1:4]    theta2 <- theta[5:8]    sum(sqrt(theta1 * theta2))    }  data <- list(T1 = c(2,1,2,1), T2 = c(0,1,3,3)) xactonomial(psi_ba, data, psi_limits = c(0, 1), maxit = 5, chunksize = 20)"},{"path":"/reference/calc_prob_null.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate probability for given parameters — calc_prob_null","title":"Calculate probability for given parameters — calc_prob_null","text":"Given set candidate parameter vectors, check null \\(\\psi \\leq \\psi_0\\) satisfied, , compute probability element sample space","code":""},{"path":"/reference/calc_prob_null.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate probability for given parameters — calc_prob_null","text":"","code":"calc_prob_null(theta_cands, psi, psi0, minus1, SSpacearr, logC, II)"},{"path":"/reference/calc_prob_null.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate probability for given parameters — calc_prob_null","text":"theta_cands matrix samples rows parameters columns psi function interest mapping parameters real line psi0 null boundary testing psi <= psi0 minus1 Either plus minus 1 SSpacearr matrix sample space given size problem logC log multinomial coefficient element sample space II logical vector sample space psi extreme observed psi","code":""},{"path":"/reference/calc_prob_null.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate probability for given parameters — calc_prob_null","text":"numeric vector probabilities","code":""},{"path":"/reference/expand_index.html","id":null,"dir":"Reference","previous_headings":"","what":"Get a matrix of indices for all possible combinations of vectors of lengths — expand_index","title":"Get a matrix of indices for all possible combinations of vectors of lengths — expand_index","text":"basically expand.grid, faster integers","code":""},{"path":"/reference/expand_index.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get a matrix of indices for all possible combinations of vectors of lengths — expand_index","text":"","code":"expand_index(lengths)"},{"path":"/reference/expand_index.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get a matrix of indices for all possible combinations of vectors of lengths — expand_index","text":"lengths vector lengths index expand","code":""},{"path":"/reference/expand_index.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get a matrix of indices for all possible combinations of vectors of lengths — expand_index","text":"matrix length(lengths) columns prod(lengths) rows","code":""},{"path":"/reference/expand_index.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get a matrix of indices for all possible combinations of vectors of lengths — expand_index","text":"","code":"expand_index(c(2, 3, 4)) #>       Var1 Var2 Var3 #>  [1,]    1    1    1 #>  [2,]    2    1    1 #>  [3,]    1    2    1 #>  [4,]    2    2    1 #>  [5,]    1    3    1 #>  [6,]    2    3    1 #>  [7,]    1    1    2 #>  [8,]    2    1    2 #>  [9,]    1    2    2 #> [10,]    2    2    2 #> [11,]    1    3    2 #> [12,]    2    3    2 #> [13,]    1    1    3 #> [14,]    2    1    3 #> [15,]    1    2    3 #> [16,]    2    2    3 #> [17,]    1    3    3 #> [18,]    2    3    3 #> [19,]    1    1    4 #> [20,]    2    1    4 #> [21,]    1    2    4 #> [22,]    2    2    4 #> [23,]    1    3    4 #> [24,]    2    3    4 ## the same as expand.grid(1:2, 1:3, 1:4) #>    Var1 Var2 Var3 #> 1     1    1    1 #> 2     2    1    1 #> 3     1    2    1 #> 4     2    2    1 #> 5     1    3    1 #> 6     2    3    1 #> 7     1    1    2 #> 8     2    1    2 #> 9     1    2    2 #> 10    2    2    2 #> 11    1    3    2 #> 12    2    3    2 #> 13    1    1    3 #> 14    2    1    3 #> 15    1    2    3 #> 16    2    2    3 #> 17    1    3    3 #> 18    2    3    3 #> 19    1    1    4 #> 20    2    1    4 #> 21    1    2    4 #> 22    2    2    4 #> 23    1    3    4 #> 24    2    3    4"},{"path":"/reference/get_theta_random.html","id":null,"dir":"Reference","previous_headings":"","what":"Sample from the unit simplex in d dimensions — get_theta_random","title":"Sample from the unit simplex in d dimensions — get_theta_random","text":"Sample unit simplex d dimensions","code":""},{"path":"/reference/get_theta_random.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sample from the unit simplex in d dimensions — get_theta_random","text":"","code":"get_theta_random(d = 4, nsamp = 75)"},{"path":"/reference/get_theta_random.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sample from the unit simplex in d dimensions — get_theta_random","text":"d dimension nsamp number samples take uniformly d space","code":""},{"path":"/reference/get_theta_random.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sample from the unit simplex in d dimensions — get_theta_random","text":"grid Theta, parameter space. matrix d columns nsamp rows","code":""},{"path":"/reference/get_theta_random.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Sample from the unit simplex in d dimensions — get_theta_random","text":"","code":"get_theta_random(3, 10) #>              [,1]       [,2]       [,3] #>  [1,] 0.080750138 0.79385052 0.12539934 #>  [2,] 0.174940627 0.65939241 0.16566696 #>  [3,] 0.034241333 0.56651955 0.39923911 #>  [4,] 0.157208442 0.16317729 0.67961427 #>  [5,] 0.007399441 0.39492880 0.59767176 #>  [6,] 0.195669835 0.27072366 0.53360650 #>  [7,] 0.403538117 0.09423927 0.50222261 #>  [8,] 0.063661457 0.22610579 0.71023276 #>  [9,] 0.388701313 0.34418067 0.26711801 #> [10,] 0.772521511 0.20302632 0.02445216"},{"path":"/reference/itp_root.html","id":null,"dir":"Reference","previous_headings":"","what":"Find the root of the function f — itp_root","title":"Find the root of the function f — itp_root","text":"finds value \\(x \\[, b]\\) \\(f(x) = 0\\) using one-dimensional root finding ITP method (Interpolate Truncate Project). Also see itp.","code":""},{"path":"/reference/itp_root.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Find the root of the function f — itp_root","text":"","code":"itp_root(   f,   a,   b,   k1 = 0.1,   k2 = 2,   n0 = 1,   eps = 0.005,   maxiter = 100,   fa = NULL,   fb = NULL,   verbose = FALSE,   ... )"},{"path":"/reference/itp_root.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Find the root of the function f — itp_root","text":"f function find root terms first (one-dimensional) argument lower limit b upper limit k1 tuning parameter k2 Another tuning parameter n0 Another tuning parameter eps Convergence tolerance maxiter Maximum number iterations fa value f(), NULL calculated fb value f(b), NULL calculated verbose Prints information iteration ... arguments passed f","code":""},{"path":"/reference/itp_root.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Find the root of the function f — itp_root","text":"numeric vector length 1, root last iteration","code":""},{"path":"/reference/itp_root.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Find the root of the function f — itp_root","text":". F. D. Oliveira R. H. C. Takahashi. 2020. Enhancement Bisection Method Average Performance Preserving Minmax Optimality. ACM Trans. Math. Softw. 47, 1, Article 5 (March 2021), 24 pages. https://doi.org/10.1145/3423597","code":""},{"path":"/reference/itp_root.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Find the root of the function f — itp_root","text":"","code":"fpoly <- function(x) x^3 - x - 2 ## example from the ITP_method wikipedia entry itp_root(fpoly, 1, 2, eps = .0001, verbose = TRUE) #> iteration:  0 candidate:  1.433333 , closest value:  -0.4886296  #> iteration:  1 candidate:  1.527131 , closest value:  0.03433833  #> iteration:  2 candidate:  1.520093 , closest value:  -0.007641477  #> iteration:  3 candidate:  1.521379 , closest value:  -4.253635e-06  #> iteration:  4 candidate:  1.521383 , closest value:  1.964979e-05  #> [1] 1.521381"},{"path":"/reference/log_multinom_coef.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate log of multinomial coefficient — log_multinom_coef","title":"Calculate log of multinomial coefficient — log_multinom_coef","text":"Calculate log multinomial coefficient","code":""},{"path":"/reference/log_multinom_coef.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate log of multinomial coefficient — log_multinom_coef","text":"","code":"log_multinom_coef(x, sumx)"},{"path":"/reference/log_multinom_coef.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate log of multinomial coefficient — log_multinom_coef","text":"x Vector observed counts cell size Total count","code":""},{"path":"/reference/log_multinom_coef.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate log of multinomial coefficient — log_multinom_coef","text":"log multinomial coefficient","code":""},{"path":"/reference/log_multinom_coef.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate log of multinomial coefficient — log_multinom_coef","text":"","code":"#' @examples S0 <- sspace_multinom(4, 6) S1 <- sspace_multinom(4, 7) logC0<- apply(S0,1,log_multinom_coef,sumx=6) logC1<- apply(S1,1,log_multinom_coef,sumx=7) logC<- outer(logC0,logC1,'+')"},{"path":"/reference/sspace_multinom.html","id":null,"dir":"Reference","previous_headings":"","what":"Enumerate the sample space of a multinomial — sspace_multinom","title":"Enumerate the sample space of a multinomial — sspace_multinom","text":"\\(d\\) mutually exclusive outcomes \\(n\\) independent trials. function enumerates possible vectors length \\(d\\) counts outcome \\(n\\) trials, .e., sample space. result output matrix \\(d\\) columns row represents possible observation.","code":""},{"path":"/reference/sspace_multinom.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Enumerate the sample space of a multinomial — sspace_multinom","text":"","code":"sspace_multinom(d, n)"},{"path":"/reference/sspace_multinom.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Enumerate the sample space of a multinomial — sspace_multinom","text":"d Dimension n Size","code":""},{"path":"/reference/sspace_multinom.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Enumerate the sample space of a multinomial — sspace_multinom","text":"matrix d columns","code":""},{"path":"/reference/sspace_multinom.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Enumerate the sample space of a multinomial — sspace_multinom","text":"","code":"d4s <- sspace_multinom(4, 8) stopifnot(abs(sum(apply(d4s, 1, dmultinom, prob = rep(.25, 4))) - 1) < 1e-12)"},{"path":"/reference/xactonomial.html","id":null,"dir":"Reference","previous_headings":"","what":"Exact inference for a real-valued function of multinomial parameters — xactonomial","title":"Exact inference for a real-valued function of multinomial parameters — xactonomial","text":"consider k sample multinomial problem observe k vectors (possibly different lengths), representing independent sample multinomial. given function psi takes concatenated vector multinomial probabilities outputs real number, interested constructing confidence interval psi.","code":""},{"path":"/reference/xactonomial.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Exact inference for a real-valued function of multinomial parameters — xactonomial","text":"","code":"xactonomial(psi, data, alpha = 0.05, psi_limits, maxit = 50, chunksize = 500)"},{"path":"/reference/xactonomial.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Exact inference for a real-valued function of multinomial parameters — xactonomial","text":"psi Function takes vector parameters outputs real valued number data list k elements representing vectors counts k-sample multinomial alpha 1 - alpha percent confidence interval computed psi_limits vector length 2 giving lower upper limits range \\(\\psi(\\theta)\\) maxit Maximum number iterations stochastic procedure chunksize number samples taken parameter space iteration","code":""},{"path":"/reference/xactonomial.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Exact inference for a real-valued function of multinomial parameters — xactonomial","text":"list 3 elements: estimate, 1 - alpha percent   confidence interval, function calculation p-values","code":""},{"path":"/reference/xactonomial.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Exact inference for a real-valued function of multinomial parameters — xactonomial","text":"Let \\(T_j\\) distributed \\(\\mbox{Multinomial}_{d_j}(\\boldsymbol{\\theta}_j, n_j)\\) \\(j = 1, \\ldots, k\\) denote \\(\\boldsymbol{T} = (T_1, \\ldots, T_k)\\) \\(\\boldsymbol{\\theta} = (\\theta_1, \\ldots, \\theta_k)\\). subscript \\(d_j\\) denotes dimension multinomial. Suppose one interested parameter \\(\\psi(\\boldsymbol{\\theta}) \\\\Theta \\subseteq \\mathbb{R}\\). Given sample size \\(n\\) \\(\\boldsymbol{T}\\), one can estimate \\(\\boldsymbol{\\theta}\\) sample proportions \\(\\hat{\\boldsymbol{\\theta}}\\) hence \\(\\pi(\\hat{\\boldsymbol{\\theta}})\\). function constructs \\(1 - \\alpha\\) percent confidence interval \\(\\psi(\\boldsymbol{\\theta})\\) provides function calculate p value test null hypothesis \\(H_0: \\psi(\\boldsymbol{\\theta}) \\leq \\psi_0\\). make assumptions rely large sample approximations. computation somewhat involved best small sample sizes.","code":""},{"path":"/reference/xactonomial.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Exact inference for a real-valued function of multinomial parameters — xactonomial","text":"","code":"psi_ba <- function(theta) {   theta1 <- theta[1:4]   theta2 <- theta[5:8]   sum(sqrt(theta1 * theta2))   } data <- list(T1 = c(2,1,2,1), T2 = c(0,1,3,3)) xactonomial(psi_ba, data, psi_limits = c(0, 1), maxit = 5, chunksize = 20) #> $estimate #> [1] 0.7995291 #>  #> $conf.int #> [1] 0.6025000 0.9912402 #>  #> $pvalue_function #> function (psi0, maxit = maxit, chunksize = chunksize, lower = TRUE,  #>     target = alpha/2, psi_limits = psi_limits, SSpacearr = SSpacearr,  #>     logC = logC)  #> { #>     minus1 <- if (lower)  #>         1 #>     else -1 #>     II <- if (lower)  #>         psi_hat >= psi_obs #>     else psi_hat <= psi_obs #>     seqmaxes <- rep(NA, maxit) #>     for (i in 1:maxit) { #>         theta_cands <- do.call(cbind, lapply(d_k, function(i) get_theta_random(i,  #>             chunksize))) #>         these_probs <- calc_prob_null(theta_cands, psi, psi0,  #>             minus1, SSpacearr, logC, II) #>         if (length(these_probs) == 0)  #>             next #>         cand <- c(seqmaxes, these_probs) #>         if (all(is.na(cand)))  #>             seqmaxes[i] <- 1e-12 #>         else { #>             seqmaxes[i] <- max(cand, na.rm = TRUE) #>         } #>         if (seqmaxes[i] > target + 0.001)  #>             break #>     } #>     if (all(is.na(seqmaxes)))  #>         return(1e-12) #>     else max(seqmaxes, na.rm = TRUE) #> } #> <bytecode: 0x55efdc829c08> #> <environment: 0x55efdc830df8> #>"},{"path":"/news/index.html","id":"xactonomial-010","dir":"Changelog","previous_headings":"","what":"xactonomial 0.1.0","title":"xactonomial 0.1.0","text":"Initial release.","code":""}]
