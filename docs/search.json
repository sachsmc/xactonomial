[{"path":"https://sachsmc.github.io/xactonomial/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2024 Michael C Sachs Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://sachsmc.github.io/xactonomial/articles/example.html","id":"maximum-of-parameters","dir":"Articles","previous_headings":"","what":"Maximum of parameters","title":"Basic Examples","text":"example, τ(θ)=max(θ)\\tau(\\theta) = \\max(\\theta). two parameters equal, function nondifferentiable, bootstrap asymptotic methods fail method still works. can get rid warning providing argument p_value_limits vector 2 p-values, first test null lower boundary psi second upper boundary. p-values greater α/2\\alpha / 2, root exists confidence limit instead boundary. First calculate exact p-value test psi0 <= 1/3 providing theta_null_points. upper p-value clearly less α/2\\alpha / 2. provide vector 2 p-values function. need precise, important thing one greater α/2\\alpha / 2. Now can see get exactly 1/3 lower confidence limit.","code":"tau_max <- function(pp) {     max(pp)    }  true_tau <- tau_max(c(.4, .4, .2))  sample_data2 <- function(n) {      list(rmultinom(1, n, prob = c(.4, .4, .2))[, 1])    }  set.seed(421) data <- sample_data2(n = c(60)) data #> [[1]] #> [1] 27 25  8 results <- xactonomial(data, tau_max, psi_limits = c(1/3,1), psi0 = .55,                           maxit = 100, chunksize = 1000, itp_eps = .01) #> Warning in xactonomial(data, tau_max, psi_limits = c(1/3, 1), psi0 = 0.55, : No #> root found for lower confidence limit, using lower boundary.  results #>  #>  Monte Carlo multinomial test #>  #> data:  data #> p-value = 0.154 #> alternative hypothesis: true psi0 is not equal to 0.55 #> 95 percent confidence interval: #>  0.3333333 0.5883333 #> sample estimates: #> tau_max  #>    0.45 p.ll <- xactonomial(data, tau_max, psi_limits = c(1/3,1), psi0 = 1/3, conf_int = FALSE,    itp_eps = .01, theta_null_points = t(rep(1/3, 3)),     alternative = \"greater\")$p.value  xactonomial(data, tau_max, psi_limits = c(1/3,1), psi0 = 1, conf_int = FALSE,    itp_eps = .01, theta_null_points = rbind(c(1, 0, 0), c(0,1,0), c(0,0,1)),     alternative = \"less\")$p.value #> [1] 0 xactonomial(data, tau_max, psi_limits = c(1/3,1), p_value_limits = c(p.ll, 1e-8),                           maxit = 100, chunksize = 1000, itp_eps = .01) #>  #>  Monte Carlo multinomial test #>  #> data:  data #> p-value = NA #> alternative hypothesis: two.sided #> 95 percent confidence interval: #>  0.3333333 0.5883333 #> sample estimates: #> tau_max  #>    0.45"},{"path":[]},{"path":"https://sachsmc.github.io/xactonomial/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Michael C Sachs. Author, maintainer. Michael P Fay. Author. Erin E Gabriel. Author. David B Dahl. Contributor.           (rbindings.rs)","code":""},{"path":"https://sachsmc.github.io/xactonomial/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Sachs M, Fay M, Gabriel E (2025). xactonomial: Inference Functions Multinomial Parameters. R package version 1.2.0, https://sachsmc.github.io/xactonomial/.","code":"@Manual{,   title = {xactonomial: Inference for Functions of Multinomial Parameters},   author = {Michael C Sachs and Michael P Fay and Erin E Gabriel},   year = {2025},   note = {R package version 1.2.0},   url = {https://sachsmc.github.io/xactonomial/}, }"},{"path":"https://sachsmc.github.io/xactonomial/index.html","id":"xactonomial","dir":"","previous_headings":"","what":"Inference for Functions of Multinomial Parameters","title":"Inference for Functions of Multinomial Parameters","text":"goal xactonomial use exact (computational stochastic) method compute confidence interval function calculation p values k sample multinomial setting interest real-valued functional multinomial probabilities.","code":""},{"path":"https://sachsmc.github.io/xactonomial/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Inference for Functions of Multinomial Parameters","text":"can install development version xactonomial like : building package source requires local rust environment. Instead, pre-built binaries can found https://sachsmc.r-universe.dev/xactonomial used directly R ","code":"remotes::install_github(\"sachsmc/xactonomial\") install.packages(\"xactonomial\", repos = c('https://sachsmc.r-universe.dev', 'https://cloud.r-project.org'))"},{"path":"https://sachsmc.github.io/xactonomial/index.html","id":"example","dir":"","previous_headings":"","what":"Example","title":"Inference for Functions of Multinomial Parameters","text":"basic example shows use main function:","code":"library(xactonomial)  tau_ba <- function(theta) {    theta1 <- theta[1:4]    theta2 <- theta[5:8]    sum(sqrt(theta1 * theta2))    }  data <- list(T1 = c(2,1,2,1), T2 = c(0,1,3,3)) xactonomial(data, f_param = tau_ba, psi_limits = c(0, 1), maxit = 5, chunksize = 20)"},{"path":"https://sachsmc.github.io/xactonomial/reference/calc_multinom_probs.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate multinomial probabilities — calc_multinom_probs","title":"Calculate multinomial probabilities — calc_multinom_probs","text":"Calculate multinomial probabilities","code":""},{"path":"https://sachsmc.github.io/xactonomial/reference/calc_multinom_probs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate multinomial probabilities — calc_multinom_probs","text":"","code":"calc_multinom_probs(sar, logt, logc, d, n, nt)"},{"path":"https://sachsmc.github.io/xactonomial/reference/calc_multinom_probs.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate multinomial probabilities — calc_multinom_probs","text":"sar unrolled matrix containing portion sample space sum logt vector candidate theta values, sampled null space logc vector log multinomial coefficients see log_multinom_coef d total dimension, sum(d_j) n sample size nt number candidate theta values","code":""},{"path":"https://sachsmc.github.io/xactonomial/reference/calc_multinom_probs.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate multinomial probabilities — calc_multinom_probs","text":"vector probabilities","code":""},{"path":"https://sachsmc.github.io/xactonomial/reference/calc_multinom_probs.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate multinomial probabilities — calc_multinom_probs","text":"","code":"sspace_3_5 <- sspace_multinom(3, 5) calc_multinom_probs(sspace_3_5, sample_unit_simplexn(3, 10),   apply(matrix(sspace_3_5, ncol = 3, byrow = TRUE), 1, log_multinom_coef, sumx = 5), 3, 5, 10) #>  [1] 142.02929 106.60159 108.70758 295.14131 304.71594  69.98053  84.68910 #>  [8]  86.55943 357.01053 168.54551"},{"path":"https://sachsmc.github.io/xactonomial/reference/calc_prob_null.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate probability for given parameters — calc_prob_null","title":"Calculate probability for given parameters — calc_prob_null","text":"Given set candidate parameter vectors, enumerated sample space, logical vector number elements sample space, compute probability element sample space take sum.","code":""},{"path":"https://sachsmc.github.io/xactonomial/reference/calc_prob_null.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate probability for given parameters — calc_prob_null","text":"","code":"calc_prob_null(theta_cands, SSpacearr, logC, II)"},{"path":"https://sachsmc.github.io/xactonomial/reference/calc_prob_null.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate probability for given parameters — calc_prob_null","text":"theta_cands matrix samples rows parameters columns SSpacearr matrix sample space given size problem logC log multinomial coefficient element sample space II logical vector statistic elements sample space statistic extreme observed statistic","code":""},{"path":"https://sachsmc.github.io/xactonomial/reference/calc_prob_null.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate probability for given parameters — calc_prob_null","text":"numeric vector probabilities","code":""},{"path":"https://sachsmc.github.io/xactonomial/reference/calc_prob_null.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate probability for given parameters — calc_prob_null","text":"","code":"sspace_3_5 <- matrix(sspace_multinom(3, 5), ncol = 3, byrow = TRUE) theta_cands <- matrix(sample_unit_simplexn(3, 10), ncol = 3,byrow = TRUE) calc_prob_null_fast(theta_cands, sspace_3_5, apply(sspace_3_5, 1, log_multinom_coef, sumx = 5), II = 1:21 > 12) #>  [1] 0.002097703 0.772156191 0.178314471 0.989209809 0.561304457 0.618540630 #>  [7] 0.014504900 0.954887016 0.385190669 0.246720639 # same as below but faster calc_prob_null(theta_cands, sspace_3_5, apply(sspace_3_5, 1, log_multinom_coef, sumx = 5), II = 1:21 > 12) #>  [1] 0.002097703 0.772156191 0.178314471 0.989209809 0.561304457 0.618540630 #>  [7] 0.014504900 0.954887016 0.385190669 0.246720639"},{"path":"https://sachsmc.github.io/xactonomial/reference/calc_prob_null2.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate probability for given parameters — calc_prob_null2","title":"Calculate probability for given parameters — calc_prob_null2","text":"Given set candidate parameter vectors, check null \\(\\psi \\leq \\psi_0\\) satisfied, , compute probability element sample space","code":""},{"path":"https://sachsmc.github.io/xactonomial/reference/calc_prob_null2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate probability for given parameters — calc_prob_null2","text":"","code":"calc_prob_null2(   theta_cands,   psi,   psi0,   minus1,   SSpacearr,   logC,   II,   psi_v = FALSE )"},{"path":"https://sachsmc.github.io/xactonomial/reference/calc_prob_null2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate probability for given parameters — calc_prob_null2","text":"theta_cands matrix samples rows parameters columns psi function interest mapping parameters real line psi0 null boundary testing psi <= psi0 minus1 Either plus minus 1 SSpacearr matrix sample space given size problem logC log multinomial coefficient element sample space II logical vector sample space psi extreme observed psi psi_v psi vectorized row?","code":""},{"path":"https://sachsmc.github.io/xactonomial/reference/calc_prob_null2.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate probability for given parameters — calc_prob_null2","text":"numeric vector probabilities","code":""},{"path":"https://sachsmc.github.io/xactonomial/reference/calc_prob_null_fast.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate probability for given parameters — calc_prob_null_fast","title":"Calculate probability for given parameters — calc_prob_null_fast","text":"Given set candidate parameter vectors, enumerated sample space, logical vector number elements sample space, compute probability element sample space take sum.","code":""},{"path":"https://sachsmc.github.io/xactonomial/reference/calc_prob_null_fast.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate probability for given parameters — calc_prob_null_fast","text":"","code":"calc_prob_null_fast(theta_cands, SSpacearr, logC, II)"},{"path":"https://sachsmc.github.io/xactonomial/reference/calc_prob_null_fast.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate probability for given parameters — calc_prob_null_fast","text":"theta_cands matrix samples rows parameters columns SSpacearr matrix sample space given size problem logC log multinomial coefficient element sample space II logical vector statistic elements sample space statistic extreme observed statistic","code":""},{"path":"https://sachsmc.github.io/xactonomial/reference/calc_prob_null_fast.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate probability for given parameters — calc_prob_null_fast","text":"numeric vector probabilities","code":""},{"path":"https://sachsmc.github.io/xactonomial/reference/calc_prob_null_fast.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate probability for given parameters — calc_prob_null_fast","text":"","code":"sspace_3_5 <- matrix(sspace_multinom(3, 5), ncol = 3, byrow = TRUE) theta_cands <- matrix(sample_unit_simplexn(3, 10), ncol = 3,byrow = TRUE) calc_prob_null_fast(theta_cands, sspace_3_5, apply(sspace_3_5, 1, log_multinom_coef, sumx = 5), II = 1:21 > 12) #>  [1] 0.0004533876 0.0076767952 0.7663105384 0.7588514445 0.2469748988 #>  [6] 0.4370544499 0.9424411110 0.2058095289 0.6428573567 0.6580170530 # same as below but faster calc_prob_null(theta_cands, sspace_3_5, apply(sspace_3_5, 1, log_multinom_coef, sumx = 5), II = 1:21 > 12) #>  [1] 0.0004533876 0.0076767952 0.7663105384 0.7588514445 0.2469748988 #>  [6] 0.4370544499 0.9424411110 0.2058095289 0.6428573567 0.6580170530"},{"path":"https://sachsmc.github.io/xactonomial/reference/calc_prob_null_gradient.html","id":null,"dir":"Reference","previous_headings":"","what":"Gradient of the multinomial likelihood sum — calc_prob_null_gradient","title":"Gradient of the multinomial likelihood sum — calc_prob_null_gradient","text":"Gradient multinomial likelihood sum","code":""},{"path":"https://sachsmc.github.io/xactonomial/reference/calc_prob_null_gradient.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Gradient of the multinomial likelihood sum — calc_prob_null_gradient","text":"","code":"calc_prob_null_gradient(theta_cands, SSpacearr, II)"},{"path":"https://sachsmc.github.io/xactonomial/reference/calc_prob_null_gradient.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Gradient of the multinomial likelihood sum — calc_prob_null_gradient","text":"theta_cands matrix samples rows parameters columns SSpacearr matrix sample space given size problem II logical vector statistic elements sample space statistic extreme observed statistic","code":""},{"path":"https://sachsmc.github.io/xactonomial/reference/calc_prob_null_gradient.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Gradient of the multinomial likelihood sum — calc_prob_null_gradient","text":"matrix dimension theta_cands","code":""},{"path":"https://sachsmc.github.io/xactonomial/reference/calc_prob_null_gradient.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Gradient of the multinomial likelihood sum — calc_prob_null_gradient","text":"","code":"calc_prob_null_gradient(t(c(.28, .32, .4)), matrix(c(2, 2, 1, 1, 2, 2, 0, 3, 2), ncol = 3), rep(TRUE, 3)) #>          [,1]      [,2]       [,3] #> [1,] 0.199254 0.1102833 0.02679112  # numerically testenv <- new.env() testenv$SSpacearr <- matrix(c(2, 2, 1, 1, 2, 2, 0, 3, 2), ncol = 3) testenv$thistheta <- c(.28, .32, .4) numericDeriv(quote(sum(exp((.colSums(t(SSpacearr) * log(thistheta), m = 3, n = 3))))),     theta = \"thistheta\", rho = testenv, central = TRUE) #> [1] 0.03018932 #> attr(,\"gradient\") #>          [,1]      [,2]       [,3] #> [1,] 0.199254 0.1102833 0.02679112"},{"path":"https://sachsmc.github.io/xactonomial/reference/calc_probs_rust.html","id":null,"dir":"Reference","previous_headings":"","what":"calculate multinomial probabilities — calc_probs_rust","title":"calculate multinomial probabilities — calc_probs_rust","text":"calculate multinomial probabilities","code":""},{"path":"https://sachsmc.github.io/xactonomial/reference/calc_probs_rust.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"calculate multinomial probabilities — calc_probs_rust","text":"","code":"calc_probs_rust(sar, logt, logc, d, n, nt)"},{"path":"https://sachsmc.github.io/xactonomial/reference/combinate.html","id":null,"dir":"Reference","previous_headings":"","what":"Arrange all combinations of rows of two matrices — combinate","title":"Arrange all combinations of rows of two matrices — combinate","text":"Given X Y, matrices rows counts multinomial trials, produce combinations rowwise, concatenate rows new matrix, calculate log multinomial coefficients combination.","code":""},{"path":"https://sachsmc.github.io/xactonomial/reference/combinate.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Arrange all combinations of rows of two matrices — combinate","text":"","code":"combinate(X, Y)"},{"path":"https://sachsmc.github.io/xactonomial/reference/combinate.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Arrange all combinations of rows of two matrices — combinate","text":"X Matrix 1 Y Matrix 2","code":""},{"path":"https://sachsmc.github.io/xactonomial/reference/combinate.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Arrange all combinations of rows of two matrices — combinate","text":"list containing Sspace, sample space (vectors counts),  logC, vector log multinomial coefficients.","code":""},{"path":"https://sachsmc.github.io/xactonomial/reference/combinate.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Arrange all combinations of rows of two matrices — combinate","text":"","code":"slist_2_3 <- combinate(matrix(sspace_multinom(2, 5), ncol = 2, byrow = TRUE),    matrix(sspace_multinom(3, 6), ncol = 3, byrow = TRUE))"},{"path":"https://sachsmc.github.io/xactonomial/reference/combinate2.html","id":null,"dir":"Reference","previous_headings":"","what":"Like combinate but adds on to previous call — combinate2","title":"Like combinate but adds on to previous call — combinate2","text":"Like combinate adds previous call","code":""},{"path":"https://sachsmc.github.io/xactonomial/reference/combinate2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Like combinate but adds on to previous call — combinate2","text":"","code":"combinate2(X, Y)"},{"path":"https://sachsmc.github.io/xactonomial/reference/combinate2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Like combinate but adds on to previous call — combinate2","text":"X list containing elements Sspace (matrix), logC (vector), result call combinate Y Matrix 2","code":""},{"path":"https://sachsmc.github.io/xactonomial/reference/combinate2.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Like combinate but adds on to previous call — combinate2","text":"list containing Sspace, sample space (vectors counts),  logC, vector log multinomial coefficients.","code":""},{"path":"https://sachsmc.github.io/xactonomial/reference/combinate2.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Like combinate but adds on to previous call — combinate2","text":"","code":"slist_2_3 <- combinate(matrix(sspace_multinom(2, 5), ncol = 2, byrow = TRUE),    matrix(sspace_multinom(3, 6), ncol = 3, byrow = TRUE))  sl_2_3_4 <- combinate2(slist_2_3, matrix(sspace_multinom(4, 3), ncol = 4, byrow = TRUE))"},{"path":"https://sachsmc.github.io/xactonomial/reference/expand_index.html","id":null,"dir":"Reference","previous_headings":"","what":"Get a matrix of indices for all possible combinations of vectors of lengths — expand_index","title":"Get a matrix of indices for all possible combinations of vectors of lengths — expand_index","text":"basically expand.grid, faster integers","code":""},{"path":"https://sachsmc.github.io/xactonomial/reference/expand_index.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get a matrix of indices for all possible combinations of vectors of lengths — expand_index","text":"","code":"expand_index(lengths)"},{"path":"https://sachsmc.github.io/xactonomial/reference/expand_index.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get a matrix of indices for all possible combinations of vectors of lengths — expand_index","text":"lengths vector lengths index expand","code":""},{"path":"https://sachsmc.github.io/xactonomial/reference/expand_index.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get a matrix of indices for all possible combinations of vectors of lengths — expand_index","text":"matrix length(lengths) columns prod(lengths) rows","code":""},{"path":"https://sachsmc.github.io/xactonomial/reference/expand_index.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get a matrix of indices for all possible combinations of vectors of lengths — expand_index","text":"","code":"expand_index(c(2, 3, 4)) #>       Var1 Var2 Var3 #>  [1,]    1    1    1 #>  [2,]    2    1    1 #>  [3,]    1    2    1 #>  [4,]    2    2    1 #>  [5,]    1    3    1 #>  [6,]    2    3    1 #>  [7,]    1    1    2 #>  [8,]    2    1    2 #>  [9,]    1    2    2 #> [10,]    2    2    2 #> [11,]    1    3    2 #> [12,]    2    3    2 #> [13,]    1    1    3 #> [14,]    2    1    3 #> [15,]    1    2    3 #> [16,]    2    2    3 #> [17,]    1    3    3 #> [18,]    2    3    3 #> [19,]    1    1    4 #> [20,]    2    1    4 #> [21,]    1    2    4 #> [22,]    2    2    4 #> [23,]    1    3    4 #> [24,]    2    3    4 ## the same as expand.grid(1:2, 1:3, 1:4) #>    Var1 Var2 Var3 #> 1     1    1    1 #> 2     2    1    1 #> 3     1    2    1 #> 4     2    2    1 #> 5     1    3    1 #> 6     2    3    1 #> 7     1    1    2 #> 8     2    1    2 #> 9     1    2    2 #> 10    2    2    2 #> 11    1    3    2 #> 12    2    3    2 #> 13    1    1    3 #> 14    2    1    3 #> 15    1    2    3 #> 16    2    2    3 #> 17    1    3    3 #> 18    2    3    3 #> 19    1    1    4 #> 20    2    1    4 #> 21    1    2    4 #> 22    2    2    4 #> 23    1    3    4 #> 24    2    3    4"},{"path":"https://sachsmc.github.io/xactonomial/reference/get_theta_random.html","id":null,"dir":"Reference","previous_headings":"","what":"Sample from the unit simplex in d dimensions — get_theta_random","title":"Sample from the unit simplex in d dimensions — get_theta_random","text":"Sample unit simplex d dimensions","code":""},{"path":"https://sachsmc.github.io/xactonomial/reference/get_theta_random.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sample from the unit simplex in d dimensions — get_theta_random","text":"","code":"get_theta_random(d = 4, nsamp = 75)"},{"path":"https://sachsmc.github.io/xactonomial/reference/get_theta_random.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sample from the unit simplex in d dimensions — get_theta_random","text":"d dimension nsamp number samples take uniformly d space","code":""},{"path":"https://sachsmc.github.io/xactonomial/reference/get_theta_random.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sample from the unit simplex in d dimensions — get_theta_random","text":"grid Theta, parameter space. matrix d columns nsamp rows","code":""},{"path":"https://sachsmc.github.io/xactonomial/reference/get_theta_random.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Sample from the unit simplex in d dimensions — get_theta_random","text":"","code":"get_theta_random(3, 10) #>              [,1]       [,2]       [,3] #>  [1,] 0.080750138 0.75358290 0.16566696 #>  [2,] 0.157208442 0.44355244 0.39923911 #>  [3,] 0.007399441 0.45899406 0.53360650 #>  [4,] 0.289767245 0.20801014 0.50222261 #>  [5,] 0.732881987 0.03963952 0.22747849 #>  [6,] 0.174940627 0.69966003 0.12539934 #>  [7,] 0.034241333 0.28614440 0.67961427 #>  [8,] 0.195669835 0.20665840 0.59767176 #>  [9,] 0.063661457 0.33987666 0.59646188 #> [10,] 0.388701313 0.58684652 0.02445216"},{"path":"https://sachsmc.github.io/xactonomial/reference/itp_root.html","id":null,"dir":"Reference","previous_headings":"","what":"Find a univariate root of the function f — itp_root","title":"Find a univariate root of the function f — itp_root","text":"finds value \\(x \\[, b]\\) \\(f(x) = 0\\) using one-dimensional root finding ITP method (Interpolate Truncate Project). Also see itp.","code":""},{"path":"https://sachsmc.github.io/xactonomial/reference/itp_root.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Find a univariate root of the function f — itp_root","text":"","code":"itp_root(   f,   a,   b,   k1 = 0.1,   k2 = 2,   n0 = 1,   eps = 0.005,   maxiter = 100,   fa = NULL,   fb = NULL,   verbose = FALSE,   ... )"},{"path":"https://sachsmc.github.io/xactonomial/reference/itp_root.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Find a univariate root of the function f — itp_root","text":"f function find root terms first (one-dimensional) argument lower limit b upper limit k1 tuning parameter k2 Another tuning parameter n0 Another tuning parameter eps Convergence tolerance maxiter Maximum number iterations fa value f(), NULL calculated fb value f(b), NULL calculated verbose Prints information iteration ... arguments passed f","code":""},{"path":"https://sachsmc.github.io/xactonomial/reference/itp_root.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Find a univariate root of the function f — itp_root","text":"numeric vector length 1, root last iteration","code":""},{"path":"https://sachsmc.github.io/xactonomial/reference/itp_root.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Find a univariate root of the function f — itp_root","text":". F. D. Oliveira R. H. C. Takahashi. 2020. Enhancement Bisection Method Average Performance Preserving Minmax Optimality. ACM Trans. Math. Softw. 47, 1, Article 5 (March 2021), 24 pages. https://doi.org/10.1145/3423597","code":""},{"path":"https://sachsmc.github.io/xactonomial/reference/itp_root.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Find a univariate root of the function f — itp_root","text":"","code":"fpoly <- function(x) x^3 - x - 2 ## example from the ITP_method wikipedia entry itp_root(fpoly, 1, 2, eps = .0001, verbose = TRUE) #> iteration:  0 candidate:  1.433333 , closest value:  -0.4886296  #> iteration:  1 candidate:  1.527131 , closest value:  0.03433833  #> iteration:  2 candidate:  1.520093 , closest value:  -0.007641477  #> iteration:  3 candidate:  1.521379 , closest value:  -4.253635e-06  #> iteration:  4 candidate:  1.521383 , closest value:  1.964979e-05  #> [1] 1.521381 #> attr(,\"iter\") #> [1] 4"},{"path":"https://sachsmc.github.io/xactonomial/reference/log_multinom_coef.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate log of multinomial coefficient — log_multinom_coef","title":"Calculate log of multinomial coefficient — log_multinom_coef","text":"Calculate log multinomial coefficient","code":""},{"path":"https://sachsmc.github.io/xactonomial/reference/log_multinom_coef.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate log of multinomial coefficient — log_multinom_coef","text":"","code":"log_multinom_coef(x, sumx)"},{"path":"https://sachsmc.github.io/xactonomial/reference/log_multinom_coef.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate log of multinomial coefficient — log_multinom_coef","text":"x Vector observed counts cell sumx Total count","code":""},{"path":"https://sachsmc.github.io/xactonomial/reference/log_multinom_coef.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate log of multinomial coefficient — log_multinom_coef","text":"vector log multinomial coefficients","code":""},{"path":"https://sachsmc.github.io/xactonomial/reference/log_multinom_coef.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate log of multinomial coefficient — log_multinom_coef","text":"","code":"S0 <- matrix(sspace_multinom(4, 6), ncol = 4, byrow = TRUE) logC0<- apply(S0,1,log_multinom_coef,sumx=6)"},{"path":"https://sachsmc.github.io/xactonomial/reference/pvalue_psi0.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute a p value for the test of psi <= psi0 and/or psi >= psi0 — pvalue_psi0","title":"Compute a p value for the test of psi <= psi0 and/or psi >= psi0 — pvalue_psi0","text":"Compute p value test psi <= psi0 /psi >= psi0","code":""},{"path":"https://sachsmc.github.io/xactonomial/reference/pvalue_psi0.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute a p value for the test of psi <= psi0 and/or psi >= psi0 — pvalue_psi0","text":"","code":"pvalue_psi0(   psi0,   f_param,   psi_hat,   psi_obs,   alternative = \"two.sided\",   maxit,   chunksize,   p_target,   SSpacearr,   logC,   d_k,   f_is_vectorized = FALSE,   theta_sampler = runif_dk_vects,   ga = FALSE,   ga_gfactor = 1,   ga_lrate = 0.01,   ga_restart_every = 10,   warn = TRUE )"},{"path":"https://sachsmc.github.io/xactonomial/reference/pvalue_psi0.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute a p value for the test of psi <= psi0 and/or psi >= psi0 — pvalue_psi0","text":"psi0 null hypothesis value parameter tested. f_param Function takes parameters outputs real valued number parameter. Can vectorized rowwise matrix . psi_hat vector psi values element sample space psi_obs observed estimate given data alternative character string specifying alternative hypothesis, must one \"two.sided\" (default), \"greater\" \"less\" maxit Maximum number iterations Monte Carlo procedure chunksize number samples take parameter space iteration p_target p-value found greater p_target, terminate algorithm early. SSpacearr sample space matrix logC log multinomial coefficients row sample space d_k vector dimensions f_is_vectorized f_param vectorized row? theta_sampler Function take samples \\(Theta\\) parameter space. Default runif_dk_vects. ga Logical, TRUE, uses gradient ascent. ga_gfactor Concentration parameter scale gradient ascent algorithm. number \"adapt\" ga_lrate gradient ascent learning rate ga_restart_every Restart gradient ascent number iterations sample warn TRUE, give warning samples null space found","code":""},{"path":"https://sachsmc.github.io/xactonomial/reference/pvalue_psi0.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute a p value for the test of psi <= psi0 and/or psi >= psi0 — pvalue_psi0","text":"vector two p-values, one lower, one greater","code":""},{"path":"https://sachsmc.github.io/xactonomial/reference/pvalue_psi0.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compute a p value for the test of psi <= psi0 and/or psi >= psi0 — pvalue_psi0","text":"","code":"sspace_3_5 <- matrix(sspace_multinom(3, 5), ncol = 3, byrow = TRUE) f_max <- function(theta) max(theta) logC <- apply(sspace_3_5, 1, log_multinom_coef, sumx = 5) psi_hat <- apply(sspace_3_5, 1, \\(x) f_max(x / sum(x))) pvalue_psi0(.3, f_max, psi_hat, .4, maxit = 10, chunksize = 100,  p_target = 1, SSpacearr = sspace_3_5, logC = logC, d_k = 3, warn = FALSE) #>      null       alt  #>        NA 0.3702166  #> attr(,\"p.sequence\") #> attr(,\"p.sequence\")$p.null #>  [1] 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 #>  #> attr(,\"p.sequence\")$p.alt #>  [1] 0.3650079 0.3681825 0.3681825 0.3681825 0.3681825 0.3702166 0.3702166 #>  [8] 0.3702166 0.3702166 0.3702166 #>"},{"path":"https://sachsmc.github.io/xactonomial/reference/rdirich_dk_vects.html","id":null,"dir":"Reference","previous_headings":"","what":"Sample independently from Dirichlet distributions for each of d_k vectors — rdirich_dk_vects","title":"Sample independently from Dirichlet distributions for each of d_k vectors — rdirich_dk_vects","text":"Sample independently Dirichlet distributions d_k vectors","code":""},{"path":"https://sachsmc.github.io/xactonomial/reference/rdirich_dk_vects.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sample independently from Dirichlet distributions for each of d_k vectors — rdirich_dk_vects","text":"","code":"rdirich_dk_vects(nsamp, alpha)"},{"path":"https://sachsmc.github.io/xactonomial/reference/rdirich_dk_vects.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sample independently from Dirichlet distributions for each of d_k vectors — rdirich_dk_vects","text":"nsamp number samples take alpha List vectors concentration parameters","code":""},{"path":"https://sachsmc.github.io/xactonomial/reference/rdirich_dk_vects.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sample independently from Dirichlet distributions for each of d_k vectors — rdirich_dk_vects","text":"matrix sum(d_k) columns nsamp rows","code":""},{"path":"https://sachsmc.github.io/xactonomial/reference/rdirich_dk_vects.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Sample independently from Dirichlet distributions for each of d_k vectors — rdirich_dk_vects","text":"","code":"rdirich_dk_vects(10, list(rep(1, 3), rep(1, 4), rep(1, 2))) #>             [,1]      [,2]       [,3]       [,4]       [,5]         [,6] #>  [1,] 0.20535040 0.7595615 0.03508807 0.20126471 0.00285332 0.6554100994 #>  [2,] 0.31718216 0.4226124 0.26020543 0.62109607 0.05350141 0.0929134871 #>  [3,] 0.07176754 0.2074761 0.72075637 0.30401325 0.24915756 0.0644091625 #>  [4,] 0.16877859 0.7032930 0.12792838 0.14873546 0.15294770 0.6470587154 #>  [5,] 0.18507012 0.6368888 0.17804104 0.40331386 0.30856744 0.1807084857 #>  [6,] 0.62897094 0.1221624 0.24886671 0.37855186 0.04199900 0.0003085087 #>  [7,] 0.17173284 0.3276306 0.50063653 0.52546676 0.11518255 0.0246033371 #>  [8,] 0.03511602 0.2689116 0.69597242 0.43610865 0.37576666 0.1366471356 #>  [9,] 0.36821220 0.4104749 0.22131290 0.35255273 0.15521903 0.4024583194 #> [10,] 0.22705310 0.6989079 0.07403897 0.05723846 0.37188783 0.1633066699 #>             [,7]       [,8]       [,9] #>  [1,] 0.14047187 0.82946319 0.17053681 #>  [2,] 0.23248903 0.02265407 0.97734593 #>  [3,] 0.38242002 0.19025265 0.80974735 #>  [4,] 0.05125812 0.11459317 0.88540683 #>  [5,] 0.10741021 0.43385001 0.56614999 #>  [6,] 0.57914063 0.38711431 0.61288569 #>  [7,] 0.33474735 0.91972516 0.08027484 #>  [8,] 0.05147755 0.63318867 0.36681133 #>  [9,] 0.08976992 0.62511716 0.37488284 #> [10,] 0.40756704 0.36088381 0.63911619"},{"path":"https://sachsmc.github.io/xactonomial/reference/runif_dk_vects.html","id":null,"dir":"Reference","previous_headings":"","what":"Sample uniformly and independently from d_k simplices — runif_dk_vects","title":"Sample uniformly and independently from d_k simplices — runif_dk_vects","text":"Sample uniformly independently d_k simplices","code":""},{"path":"https://sachsmc.github.io/xactonomial/reference/runif_dk_vects.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sample uniformly and independently from d_k simplices — runif_dk_vects","text":"","code":"runif_dk_vects(d_k, nsamp)"},{"path":"https://sachsmc.github.io/xactonomial/reference/runif_dk_vects.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sample uniformly and independently from d_k simplices — runif_dk_vects","text":"d_k vector vector lengths nsamp number samples take","code":""},{"path":"https://sachsmc.github.io/xactonomial/reference/runif_dk_vects.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sample uniformly and independently from d_k simplices — runif_dk_vects","text":"matrix sum(d_k) columns nsamp rows","code":""},{"path":"https://sachsmc.github.io/xactonomial/reference/runif_dk_vects.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Sample uniformly and independently from d_k simplices — runif_dk_vects","text":"","code":"runif_dk_vects(c(3, 4, 2), 10) #>             [,1]       [,2]       [,3]       [,4]       [,5]       [,6] #>  [1,] 0.08186903 0.31612001 0.60201096 0.30807952 0.07501580 0.45957015 #>  [2,] 0.14241759 0.59157967 0.26600274 0.10423003 0.30270546 0.57435595 #>  [3,] 0.75197552 0.10489829 0.14312619 0.15955906 0.21474925 0.02190114 #>  [4,] 0.26116626 0.72664541 0.01218833 0.08901938 0.08941726 0.79480076 #>  [5,] 0.03272872 0.42254970 0.54472157 0.01434301 0.74399737 0.24041386 #>  [6,] 0.46456797 0.25392395 0.28150808 0.35334638 0.48851445 0.15295913 #>  [7,] 0.25649604 0.23304452 0.51045944 0.38456020 0.24669553 0.12331966 #>  [8,] 0.12742798 0.22785739 0.64471464 0.03126270 0.47318230 0.12029927 #>  [9,] 0.75218639 0.01577287 0.23204074 0.28655484 0.03343276 0.56455726 #> [10,] 0.19991321 0.36293047 0.43715632 0.12874854 0.66426438 0.02725402 #>              [,7]      [,8]        [,9] #>  [1,] 0.157334532 0.2400753 0.759924693 #>  [2,] 0.018708559 0.6366479 0.363352079 #>  [3,] 0.603790548 0.7843402 0.215659802 #>  [4,] 0.026762597 0.4336132 0.566386827 #>  [5,] 0.001245758 0.6553790 0.344620999 #>  [6,] 0.005180032 0.4848650 0.515135012 #>  [7,] 0.245424607 0.2615073 0.738492680 #>  [8,] 0.375255727 0.9915906 0.008409427 #>  [9,] 0.115455134 0.3657536 0.634246439 #> [10,] 0.179733058 0.2430331 0.756966862"},{"path":"https://sachsmc.github.io/xactonomial/reference/rust_sspace.html","id":null,"dir":"Reference","previous_headings":"","what":"calculate sample space of a multinomial with dimension d and sample size n — rust_sspace","title":"calculate sample space of a multinomial with dimension d and sample size n — rust_sspace","text":"calculate sample space multinomial dimension d sample size n","code":""},{"path":"https://sachsmc.github.io/xactonomial/reference/rust_sspace.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"calculate sample space of a multinomial with dimension d and sample size n — rust_sspace","text":"","code":"rust_sspace(d, n)"},{"path":"https://sachsmc.github.io/xactonomial/reference/sample_unit_simplex.html","id":null,"dir":"Reference","previous_headings":"","what":"Return a random sample from the d unit simplex — sample_unit_simplex","title":"Return a random sample from the d unit simplex — sample_unit_simplex","text":"Return random sample d unit simplex","code":""},{"path":"https://sachsmc.github.io/xactonomial/reference/sample_unit_simplex.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Return a random sample from the d unit simplex — sample_unit_simplex","text":"","code":"sample_unit_simplex(d)"},{"path":"https://sachsmc.github.io/xactonomial/reference/sample_unit_simplex2.html","id":null,"dir":"Reference","previous_headings":"","what":"Return a random sample from the d unit simplex — sample_unit_simplex2","title":"Return a random sample from the d unit simplex — sample_unit_simplex2","text":"Return random sample d unit simplex","code":""},{"path":"https://sachsmc.github.io/xactonomial/reference/sample_unit_simplex2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Return a random sample from the d unit simplex — sample_unit_simplex2","text":"","code":"sample_unit_simplex2(d)"},{"path":"https://sachsmc.github.io/xactonomial/reference/sample_unit_simplexn.html","id":null,"dir":"Reference","previous_headings":"","what":"Sample n times from the unit simplex in d dimensions — sample_unit_simplexn","title":"Sample n times from the unit simplex in d dimensions — sample_unit_simplexn","text":"Sample n times unit simplex d dimensions","code":""},{"path":"https://sachsmc.github.io/xactonomial/reference/sample_unit_simplexn.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sample n times from the unit simplex in d dimensions — sample_unit_simplexn","text":"","code":"sample_unit_simplexn(d, n)"},{"path":"https://sachsmc.github.io/xactonomial/reference/sample_unit_simplexn.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sample n times from the unit simplex in d dimensions — sample_unit_simplexn","text":"d dimension n number samples take uniformly d space","code":""},{"path":"https://sachsmc.github.io/xactonomial/reference/sample_unit_simplexn.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sample n times from the unit simplex in d dimensions — sample_unit_simplexn","text":"grid Theta, parameter space. converted matrix d columns nsamp rows","code":""},{"path":"https://sachsmc.github.io/xactonomial/reference/sample_unit_simplexn.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Sample n times from the unit simplex in d dimensions — sample_unit_simplexn","text":"","code":"matrix(sample_unit_simplexn(3, 10), ncol = 3, byrow = TRUE) #>              [,1]       [,2]       [,3] #>  [1,] 0.718495130 0.19342793 0.08807694 #>  [2,] 0.545058828 0.05200676 0.40293441 #>  [3,] 0.670106158 0.11986601 0.21002783 #>  [4,] 0.022625113 0.20701737 0.77035752 #>  [5,] 0.272771111 0.57843816 0.14879073 #>  [6,] 0.155351288 0.64789074 0.19675797 #>  [7,] 0.200405368 0.10644329 0.69315134 #>  [8,] 0.383119368 0.15271837 0.46416226 #>  [9,] 0.098178410 0.75343204 0.14838955 #> [10,] 0.003964658 0.03780315 0.95823219"},{"path":"https://sachsmc.github.io/xactonomial/reference/sspace_multinom.html","id":null,"dir":"Reference","previous_headings":"","what":"Enumerate the multinomial sample space — sspace_multinom","title":"Enumerate the multinomial sample space — sspace_multinom","text":"Enumerate multinomial sample space","code":""},{"path":"https://sachsmc.github.io/xactonomial/reference/sspace_multinom.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Enumerate the multinomial sample space — sspace_multinom","text":"","code":"sspace_multinom(d, n)"},{"path":"https://sachsmc.github.io/xactonomial/reference/sspace_multinom.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Enumerate the multinomial sample space — sspace_multinom","text":"d dimension n sample size","code":""},{"path":"https://sachsmc.github.io/xactonomial/reference/sspace_multinom.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Enumerate the multinomial sample space — sspace_multinom","text":"vector enumerating sample space, converted matrix d columns choose(n + d - 1, d - 1) rows","code":""},{"path":"https://sachsmc.github.io/xactonomial/reference/sspace_multinom.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Enumerate the multinomial sample space — sspace_multinom","text":"","code":"matrix(sspace_multinom(3, 5), ncol = 3, byrow = TRUE) #>       [,1] [,2] [,3] #>  [1,]    5    0    0 #>  [2,]    4    1    0 #>  [3,]    3    2    0 #>  [4,]    2    3    0 #>  [5,]    1    4    0 #>  [6,]    0    5    0 #>  [7,]    4    0    1 #>  [8,]    3    1    1 #>  [9,]    2    2    1 #> [10,]    1    3    1 #> [11,]    0    4    1 #> [12,]    3    0    2 #> [13,]    2    1    2 #> [14,]    1    2    2 #> [15,]    0    3    2 #> [16,]    2    0    3 #> [17,]    1    1    3 #> [18,]    0    2    3 #> [19,]    1    0    4 #> [20,]    0    1    4 #> [21,]    0    0    5"},{"path":"https://sachsmc.github.io/xactonomial/reference/sspace_multinom_slow.html","id":null,"dir":"Reference","previous_headings":"","what":"Enumerate the sample space of a multinomial — sspace_multinom_slow","title":"Enumerate the sample space of a multinomial — sspace_multinom_slow","text":"\\(d\\) mutually exclusive outcomes \\(n\\) independent trials. function enumerates possible vectors length \\(d\\) counts outcome \\(n\\) trials, .e., sample space. result output matrix \\(d\\) columns row represents possible observation. See sspace_multinom faster implementation using Rust.","code":""},{"path":"https://sachsmc.github.io/xactonomial/reference/sspace_multinom_slow.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Enumerate the sample space of a multinomial — sspace_multinom_slow","text":"","code":"sspace_multinom_slow(d, n)"},{"path":"https://sachsmc.github.io/xactonomial/reference/sspace_multinom_slow.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Enumerate the sample space of a multinomial — sspace_multinom_slow","text":"d Dimension n Size","code":""},{"path":"https://sachsmc.github.io/xactonomial/reference/sspace_multinom_slow.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Enumerate the sample space of a multinomial — sspace_multinom_slow","text":"matrix d columns","code":""},{"path":"https://sachsmc.github.io/xactonomial/reference/sspace_multinom_slow.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Enumerate the sample space of a multinomial — sspace_multinom_slow","text":"","code":"d4s <- sspace_multinom_slow(4, 8) stopifnot(abs(sum(apply(d4s, 1, dmultinom, prob = rep(.25, 4))) - 1) < 1e-12)"},{"path":"https://sachsmc.github.io/xactonomial/reference/xactonomial-package.html","id":null,"dir":"Reference","previous_headings":"","what":"xactonomial: Exact Inference for Real-Valued Functionals of k-Sample Multinomial Parameters — xactonomial-package","title":"xactonomial: Exact Inference for Real-Valued Functionals of k-Sample Multinomial Parameters — xactonomial-package","text":"consider k sample multinomial problem observe k vectors (possibly different lengths), representing independent multinomial random vector. given function psi takes concatenated vector multinomial probabilities outputs real number, Monte Carlo estimation procedure exact p-value confidence interval. resulting inference valid even small samples, parameter boundary, function nondifferentiable parameter value, situations asymptotic methods bootstrap fail.","code":""},{"path":[]},{"path":"https://sachsmc.github.io/xactonomial/reference/xactonomial-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"xactonomial: Exact Inference for Real-Valued Functionals of k-Sample Multinomial Parameters — xactonomial-package","text":"Maintainer: Michael C Sachs sachsmc@gmail.com Authors: Michael P Fay","code":""},{"path":"https://sachsmc.github.io/xactonomial/reference/xactonomial.html","id":null,"dir":"Reference","previous_headings":"","what":"Improved inference for a real-valued function of multinomial parameters — xactonomial","title":"Improved inference for a real-valued function of multinomial parameters — xactonomial","text":"consider k sample multinomial problem observe k vectors (possibly different lengths), representing independent sample multinomial. given function \\(\\tau(\\theta)\\) takes concatenated vector multinomial probabilities \\(\\theta\\) outputs real number, interested computing p-value test \\(\\tau(\\theta) = \\psi \\geq \\psi_0\\), constructing confidence interval \\(\\psi\\).","code":""},{"path":"https://sachsmc.github.io/xactonomial/reference/xactonomial.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Improved inference for a real-valued function of multinomial parameters — xactonomial","text":"","code":"xactonomial(   data,   f_param,   statistic = NULL,   psi0 = NULL,   alternative = c(\"two.sided\", \"less\", \"greater\"),   psi_limits,   theta_null_points = NULL,   p_target = 1,   conf_int = TRUE,   conf_level = 0.95,   itp_maxit = 10,   itp_eps = 0.005,   p_value_limits = NULL,   maxit = 50,   chunksize = 500,   theta_sampler = runif_dk_vects,   ga = TRUE,   ga_gfactor = \"adapt\",   ga_lrate = 0.01,   ga_restart_every = 10,   seed = 503 )"},{"path":"https://sachsmc.github.io/xactonomial/reference/xactonomial.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Improved inference for a real-valued function of multinomial parameters — xactonomial","text":"data list k elements representing vectors counts k-sample multinomial f_param Function takes parameters outputs psi, real valued number parameter. Can vectorized rowwise matrix . statistic Function takes matrix data vectors rows, outputs vector number rows matrix. NULL, inferred f_param plugging empirical proportions. psi0 null hypothesis value parameter tested. alternative character string specifying alternative hypothesis, must one \"two.sided\" (default), \"greater\" \"less\" psi_limits vector length 2 giving lower upper limits range \\(\\tau(\\theta)\\) theta_null_points optional matrix row theta value gives f_param(theta) = psi0. supplied psi0 = one psi_limits, truly exact p-value calculated. p_target p-value found greater p_target, terminate algorithm early. conf_int TRUE, calculates confidence interval inverting p-value function conf_level number 0 1, confidence level. itp_maxit Maximum iterations use ITP algorithm. relevant conf_int = TRUE. itp_eps Epsilon value use ITP algorithm. relevant conf_int = TRUE. p_value_limits vector length 2 giving lower bounds one-sided p-values corresponding psi0 = psi_limits, alternative = \"less\" \"greater\", respectively. relevant conf_int = TRUE. See examples. maxit Maximum number iterations Monte Carlo procedure chunksize number samples take parameter space iteration theta_sampler Function take samples \\(Theta\\) parameter space. Default runif_dk_vects. Must function two parameters d_k vector dimensions, chunksize number samples take, return matrix sum(d_k) columns chunksize rows. See examples. ga Logical, TRUE, uses gradient ascent. ga_gfactor Concentration parameter scale gradient ascent algorithm. number \"adapt\" ga_lrate gradient ascent learning rate ga_restart_every Restart gradient ascent number iterations sample theta_sampler seed Seed random number generator. Can set NULL case seed set.","code":""},{"path":"https://sachsmc.github.io/xactonomial/reference/xactonomial.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Improved inference for a real-valued function of multinomial parameters — xactonomial","text":"object class \"htest\", list following elements: estimate value statistic observed data p.value p value conf.int upper lower confidence limits null.value null hypothesis value provided user alternative type test method description method data.name name data object provided user p.sequence list two elements, p.null p.alt containing vector p values iteration less null greater null. Used assessing convergence.","code":""},{"path":"https://sachsmc.github.io/xactonomial/reference/xactonomial.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Improved inference for a real-valued function of multinomial parameters — xactonomial","text":"Let \\(T_j\\) distributed \\(\\mbox{Multinomial}_{d_j}(\\boldsymbol{\\theta}_j, n_j)\\) \\(j = 1, \\ldots, k\\) denote \\(\\boldsymbol{T} = (T_1, \\ldots, T_k)\\) \\(\\boldsymbol{\\theta} = (\\theta_1, \\ldots, \\theta_k)\\). subscript \\(d_j\\) denotes dimension multinomial. Suppose one interested parameter \\(\\psi = \\tau(\\boldsymbol{\\theta}) \\\\Psi \\subseteq \\mathbb{R}\\). Given sample size \\(n\\) \\(\\boldsymbol{T}\\), say \\(\\boldsymbol{X} = (X_1, \\ldots, X_k)\\), vector counts obtained concatenating k independent count vectors, let \\(G(\\boldsymbol{X})\\) denote real-valued statistic defines ordering sample space. Tne default choice statistic estimate \\(\\boldsymbol{\\theta}\\) sample proportions plug \\(\\tau(\\boldsymbol{\\theta})\\). function calculates p value test null hypothesis \\(H_0: \\psi \\neq \\psi_0\\) two sided case, \\(H_0: \\psi \\leq \\psi_0\\) case alternative = \"greater\", \\(H_0: \\psi \\geq \\psi_0\\) case alternative = \"less\". make assumptions rely large sample approximations. also optionally constructs \\(1 - \\alpha\\) percent confidence interval \\(\\psi\\). computation somewhat involved best small sample sizes. calculation done sampling large number points null parameter space \\(\\Theta_0\\), computing multinomial probabilities values range sample space statistic extreme observed statistic given data. basically definition p-value implemented Monte Carlo methods. options speeding calculation available.","code":""},{"path":"https://sachsmc.github.io/xactonomial/reference/xactonomial.html","id":"specifying-the-function-tau-cdot-","dir":"Reference","previous_headings":"","what":"Specifying the function \\(\\tau(\\cdot)\\)","title":"Improved inference for a real-valued function of multinomial parameters — xactonomial","text":"function f_param argument function either: 1) takes vector length sum(d_j) (total number bins) outputs single number, 2) takes matrix number columns equal sum(d_j), arbitrary number rows outputs vector length equal number rows. words, psi can vectorized can vectorized row. Writing vectorized can speed calculation. See examples.","code":""},{"path":"https://sachsmc.github.io/xactonomial/reference/xactonomial.html","id":"boundary-issues","dir":"Reference","previous_headings":"","what":"Boundary issues","title":"Improved inference for a real-valued function of multinomial parameters — xactonomial","text":"required provide psi_limits, vector length 2 giving smallest largest possible values function psi can take, e.g., c(0, 1). null hypothesis value psi0 one limits, often case sampling null parameter space impossible set measure 0. may measure 0, empty, contain finite set points. Thus provide argument theta_null_points matrix rows contain finite set (sometimes 1) points \\(\\theta\\) \\(\\tau(\\theta) = \\psi_0\\). also argument called p_value_limits can used improve performance confidence intervals around boundary. vector length 2 p-value test psi_0 <= psi_limits[1] p-value test psi_0 >= psi_limits[2]. See examples.","code":""},{"path":"https://sachsmc.github.io/xactonomial/reference/xactonomial.html","id":"optimization-options","dir":"Reference","previous_headings":"","what":"Optimization options","title":"Improved inference for a real-valued function of multinomial parameters — xactonomial","text":"p-value calculation, can provide parameter p_target, sampling algorithm terminates p-value found exceeds p_target. algorithm begins sampling uniformly unit simplices defining parameter space, alternatives can specified theta_sampler. default gradient ascent (ga = TRUE) performed p-value maximization procedure, ga_gfactor ga_lrate control options gradient ascent. iteration, gradient multinomial probability current maximum theta computed, step taken theta + lrate * gradient. next iteration, set chunksize samples drawn Dirichlet distribution parameter ga_gfactor * (theta + ga_lrate * gradient). ga_gfactor = \"adapt\" set 1 / max(theta) iteration. ITP algorithm itp_root used find roots p-value function function psi0 value get confidence intervals. maximum number iterations epsilon can controlled via itp_maxit, itp_eps.","code":""},{"path":"https://sachsmc.github.io/xactonomial/reference/xactonomial.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Improved inference for a real-valued function of multinomial parameters — xactonomial","text":"Sachs, M.C., Gabriel, E.E. Fay, M.P., 2024. Exact confidence intervals functions parameters k-sample multinomial problem. arXiv preprint arXiv:2406.19141.","code":""},{"path":"https://sachsmc.github.io/xactonomial/reference/xactonomial.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Improved inference for a real-valued function of multinomial parameters — xactonomial","text":"","code":"tau_ba <- function(theta) {   theta1 <- theta[1:4]   theta2 <- theta[5:8]   sum(sqrt(theta1 * theta2))   } data <- list(T1 = c(2,1,2,1), T2 = c(0,1,3,3)) xactonomial(data, tau_ba, psi_limits = c(0, 1), psi0 = .5,   conf_int = FALSE, maxit = 15, chunksize = 200) #>  #> \tMonte Carlo multinomial test #>  #> data:  data #> p-value = 0.02401 #> alternative hypothesis: true psi0 is not equal to 0.5 #> 95 percent confidence interval: #>  NA NA #> sample estimates: #>    tau_ba  #> 0.7995291  #>   # vectorized by row tau_ba_v <- function(theta) { theta1 <- theta[,1:4, drop = FALSE] theta2 <- theta[,5:8, drop = FALSE] rowSums(sqrt(theta1 * theta2)) } data <- list(T1 = c(2,1,2,1), T2 = c(0,1,3,3)) xactonomial(data, tau_ba_v, psi_limits = c(0, 1), psi0 = .5,  conf_int = FALSE, maxit = 10, chunksize = 200) #>  #> \tMonte Carlo multinomial test #>  #> data:  data #> p-value = 0.02401 #> alternative hypothesis: true psi0 is not equal to 0.5 #> 95 percent confidence interval: #>  NA NA #> sample estimates: #>  tau_ba_v  #> 0.7995291  #>    # example of using theta_null_points  # psi = 1/3 occurs when all probs = 1/3  tau_max <- function(pp) {    max(pp)  }  data <- list(c(13, 24, 13))  xactonomial(data, tau_max, psi_limits = c(1 / 3, 1), psi0 = 1/ 3,   conf_int = FALSE, theta_null_points = t(c(1/3, 1/3, 1/3))) #>  #> \tExact multinomial test given a point null #>  #> data:  data #> p-value = 0.1331 #> alternative hypothesis: true psi0 is not equal to 0.3333333 #> 95 percent confidence interval: #>  NA NA #> sample estimates: #> tau_max  #>    0.48  #>   ## in this case using p_value_limits improves confidence interval performance   xactonomial(data, tau_max, psi_limits = c(1 / 3, 1), psi0 = 1/ 3,   conf_int = TRUE, theta_null_points = t(c(1/3, 1/3, 1/3)),   p_value_limits = c(.1, 1e-8)) #>  #> \tExact multinomial test given a point null #>  #> data:  data #> p-value = 0.1331 #> alternative hypothesis: true psi0 is not equal to 0.3333333 #> 95 percent confidence interval: #>  0.3333333 0.6258333 #> sample estimates: #> tau_max  #>    0.48  #>   ## specifying theta_sampler  dirich_sampler <- function(d_k, chunksize){  rdirich_dk_vects(chunksize, list(1:4 + 1)) }  xactonomial(list(1:4),tau_max,             psi_limits = c(0.25,1), psi0 = .5, conf_int = FALSE,             theta_sampler = dirich_sampler) #>  #> \tMonte Carlo multinomial test #>  #> data:  list(1:4) #> p-value = 0.6586 #> alternative hypothesis: true psi0 is not equal to 0.5 #> 95 percent confidence interval: #>  NA NA #> sample estimates: #> tau_max  #>     0.4  #>"},{"path":"https://sachsmc.github.io/xactonomial/news/index.html","id":"xactonomial-120","dir":"Changelog","previous_headings":"","what":"xactonomial 1.2.0","title":"xactonomial 1.2.0","text":"Change argument name f_param clarity. Minor changes internal code Minor tweaks warnings, examples, documentation Improved checks confidence intervals near boundary","code":""},{"path":"https://sachsmc.github.io/xactonomial/news/index.html","id":"xactonomial-110","dir":"Changelog","previous_headings":"","what":"xactonomial 1.1.0","title":"xactonomial 1.1.0","text":"Change algorithm give sensible results points null space sampled Add seed argument default things reproducible default","code":""},{"path":"https://sachsmc.github.io/xactonomial/news/index.html","id":"xactonomial-103","dir":"Changelog","previous_headings":"","what":"xactonomial 1.0.3","title":"xactonomial 1.0.3","text":"CRAN release: 2025-04-28 Fix malformed urls Remove dependence libR-sys Change title description add argument p_value_limits confidence intervals","code":""},{"path":"https://sachsmc.github.io/xactonomial/news/index.html","id":"xactonomial-100","dir":"Changelog","previous_headings":"","what":"xactonomial 1.0.0","title":"xactonomial 1.0.0","text":"First major release. Speedups Rust implementation sample space enumeration, gradient ascent, stability root finding algorithm.","code":""},{"path":"https://sachsmc.github.io/xactonomial/news/index.html","id":"xactonomial-041","dir":"Changelog","previous_headings":"","what":"xactonomial 0.4.1","title":"xactonomial 0.4.1","text":"Speedups Seeding seed works reproducibility","code":""},{"path":"https://sachsmc.github.io/xactonomial/news/index.html","id":"xactonomial-030","dir":"Changelog","previous_headings":"","what":"xactonomial 0.3.0","title":"xactonomial 0.3.0","text":"Cleanup bugfixes","code":""},{"path":"https://sachsmc.github.io/xactonomial/news/index.html","id":"xactonomial-020","dir":"Changelog","previous_headings":"","what":"xactonomial 0.2.0","title":"xactonomial 0.2.0","text":"substantial speedups implementing things Rust using rextendr","code":""},{"path":"https://sachsmc.github.io/xactonomial/news/index.html","id":"xactonomial-010","dir":"Changelog","previous_headings":"","what":"xactonomial 0.1.0","title":"xactonomial 0.1.0","text":"Initial release.","code":""}]
